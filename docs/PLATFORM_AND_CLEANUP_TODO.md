# 플랫폼 구분 및 시행착오 정리 TODO

확장성 미고려 설계에 따른 후속 작업 정리. **시간 날 때 처리해 달라고 요청할 때 참고용** 문서입니다.

---

## 1. 플랫폼 구분 (PC Web / Mobile Web)

### 현재 상태

- **단일 플랫폼 가정**: `playwright.config.ts`는 `devices["Desktop Chrome"]` 하나만 사용. viewport·모바일 프로젝트 없음.
- **스텝/셀렉터**: `steps/`, `pages/`는 PC 웹 기준(GNB, 탭, 버튼 역할 등). 모바일 전용 UI(하단 탭, 햄버거 메뉴, 다른 DOM) 구분 없음.
- **문서**: `WEB_AUTOMATION_LIMITS.md`에 "앱 전용 플로우"는 있으나 **PC Web vs Mobile Web** 구분은 없음.

### 이렇게 두면 생기는 문제

- PC에서만 통과하는 시나리오가 모바일에서 돌면 **요소를 못 찾아 실패**할 수 있음.
- 모바일 전용 시나리오(하단 네비, 풀스크린 뷰어 등)를 나중에 넣을 때 **기존 스텝/feature와 뒤섞임**.
- "이 시나리오는 PC만 / 모바일만" 같은 **실행 단위 구분**이 없음.

### 의견 및 설계 방향

- **플랫폼을 구분하는 설계로 가는 것이 좋음.** PC Web과 Mobile Web UI/플로우가 다르다면, "한 설정으로 둘 다"보다 **처음부터 플랫폼을 나누는 설계**가 유지보수·확장에 유리함.

**추천 방향 (택 1 또는 조합):**

| 방안 | 내용 | 장점 | 단점 |
|------|------|------|------|
| **A. 프로젝트 분리** | `playwright.config`에 `chromium-desktop`, `chromium-mobile` 등 프로젝트를 두고, 각각 `viewport`·`userAgent`(또는 `devices["Pixel 5"]` 등) 지정 | 실행 시 `--project=chromium-mobile`로 플랫폼 선택 가능. Playwright 기본 패턴 | 지금은 모든 시나리오가 두 프로젝트에 다 붙음. 플랫폼별로 "돌릴 시나리오"를 나누려면 추가 작업 필요 |
| **B. 태그/디렉터리** | feature에 `@pc` / `@mobile` 태그 또는 `features/pc/`, `features/mobile/` 디렉터리로 구분 | 시나리오 단위로 "PC 전용 / 모바일 전용" 명시 가능 | 태그/경로 규칙과 config의 `testMatch`/`grep`을 맞춰야 함 |
| **C. 스텝/셀렉터 분리** | 공통 스텝은 유지하고, "GNB 클릭"처럼 플랫폼별로 다른 UI는 `steps/pc/`, `steps/mobile/` 또는 플랫폼 인자로 분기 | PC/모바일 DOM 차이를 스텝 단에서 명확히 처리 가능 | 스텝 수·분기 로직이 늘어남. fixture나 공통 헬퍼로 플랫폼 주입 필요 |

**실무적으로:**

- **단기**: A(프로젝트 분리)로 **실행 환경만** PC/모바일 구분 (같은 시나리오를 두 viewport에서 돌리는 것부터).
- **중기**: 플로우가 완전히 다른 시나리오는 B(태그 또는 디렉터리)로 **시나리오 단위**를 PC 전용 / 모바일 전용으로 나누기.
- **필요 시**: 모바일 전용 UI가 많은 KPA부터 C처럼 **스텝/셀렉터를 플랫폼별로 분리**하는 식으로 점진 적용.

지금 코드를 바꾸지 않고 "설계만 검토"하는 단계라면, **"설계 원칙"**만 정해 두는 것을 권장. 예: "PC/모바일은 config 프로젝트로 구분하고, 시나리오는 태그 또는 디렉터리로 플랫폼 명시" 정도를 이 문서 또는 별도 `docs/`에 짧게 적어 두면, 나중에 구현할 때 혼선이 줄어듦.

---

## 2. 시행착오 과정에 생성된 파일·코드 정리

### 현재 보이는 "정리 후보"

| 구분 | 항목 | 위치/예시 | 의견 |
|------|------|-----------|------|
| **백업 파일** | `*.bak` | `features/kpa-044-1.feature.bak`, `steps/kpa-040.steps.ts.bak`, `steps/kpa-044-1.steps.ts.bak` | 버전 관리는 Git이 하므로 **삭제 권장**. 필요 시 `git show` 등으로 복구 가능 |
| **일회성 로그/결과** | `overnight.log`, `overnight-results.json` | 프로젝트 루트 | 재실행으로 다시 만들 수 있으면 **삭제 또는 `.gitignore` 추가** 후 루트에서는 제거. CI/로컬 스크립트가 의존하면 경로를 `scripts/` 또는 `test-results/` 등으로 고정하는 편이 좋음 |
| **디버그 로그** | `ui-debug.log` (과거 대화에서 언급) | 루트 등 | **삭제 + `.gitignore`에 `*.log` 또는 `ui-debug.log` 추가** 권장 |
| **DOM 덤프/로그** | `dom_dumps/`, `dom_logs/` | (이미 `.gitignore`에 없을 수 있음) | 재현/디버깅용이면 **`.gitignore`에 포함**하고, 정리 스크립트(`clean-old-dumps.mjs` 등)로 주기 삭제하는 정책만 있으면 됨 |
| **자동 생성 스펙** | `.features-gen/**/*.spec.js` | BDD 생성물 | **Git 추적 여부**를 팀에서 결정. 추적한다면 "수동 수정 최소화 + bddgen 한 경로만 사용" 원칙이 있으면 좋음 |
| **중복/죽은 스텝** | 같은 문구의 스텝이 여러 파일에 정의 | 예: 과거 049/051/052/054 "Multiple definitions" | **한 시나리오/한 문구당 한 정의**로 정리하고, 나머지는 제거 또는 공통 스텝으로 이전. 정리 시 "스텁 vs 실구현" 목록과 맞춰 두면 유지보수에 유리함 |
| **스크립트** | `scripts/overnight-generate-remaining.mjs`, `clean-old-dumps.mjs` 등 | `scripts/` | "아직 사용 중인지"만 확인. 사용 안 하면 **삭제** 또는 `README`/`docs`에 "레거시/선택 사용" 표시 |

### 정리 시 권장 순서

1. **`.gitignore` 정비**  
   - `*.bak`, `overnight.log`, `overnight-results.json`, `ui-debug.log`, `dom_dumps/`, `dom_logs/` 등 시행착오/생성물이 커밋되지 않도록 추가.
2. **백업 파일 제거**  
   - `*.bak` 전부 삭제. (이미 Git에 올라가 있다면 `git rm --cached` 후 위 ignore 적용.)
3. **루트 정리**  
   - 로그/결과 파일을 루트에 두지 않고, `test-results/` 또는 `scripts/out/` 등 한 곳으로 모으는 규칙을 두기.
4. **스텝/중복 정리**  
   - "Multiple definitions" 같은 건 이미 일부 수정했을 수 있으니, **한 번 전체 검색**으로 같은 문구가 여러 번 정의된 스텝이 없는지 확인 후, 하나만 남기고 나머지는 제거하거나 공통 모듈로 옮기기.
5. **문서화**  
   - `docs/`에 "플랫폼 구분 방침(PC/Mobile)", "어떤 파일/폴더를 정리 대상으로 볼지"를 짧게 적어 두면, 나중에 새로 정리할 때도 같은 기준으로 할 수 있음.

---

## 요약

- **1. 플랫폼 구분**  
  - PC Web / Mobile Web을 **구분하는 설계로 가는 것이 좋고**, 당장 코드를 바꾸지 않더라도 "프로젝트·태그·스텝 중 무엇을 어떻게 나눌지"만 이 문서 또는 `docs/`에 정리해 두는 것을 권장.
- **2. 시행착오 정리**  
  - `.bak`, 일회성 로그/결과, 디버그 로그는 **삭제 + ignore**하고, 스텝 중복·사용 안 하는 스크립트는 **한 번 검토 후 제거/통합**하고, 정리 규칙만 문서에 남겨 두면 확장성 있게 유지할 수 있음.

---

*작성: 확장성 검토 요청에 따른 검토 결과. 시간 될 때 "이 내용대로 처리해 줘"라고 요청하면 됨.*
